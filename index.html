<!DOCTYPE html>
  <html lang="ru">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Сканер QR-кодов (ZXing)</title>
  </head>
  <body>
    <h1>Сканировать QR/штрихкод</h1>
    <video id="video" playsinline style="
    width: 100%;
    max-width: 450px;
    aspect-ratio: 4/3;
    border: 1px solid gray;
    background: #000;
    "></video>
    <p id="result"></p>
    <button id="start-btn">Старт</button>
    <button id="stop-btn">Стоп</button>
    
    <script type="module">
      import { BrowserMultiFormatReader } from 'https://cdn.jsdelivr.net/npm/@zxing/browser@latest/+esm';
  
      let codeReader;
      let controls;
  
      document.getElementById('start-btn').onclick = async () => {
        const video = document.getElementById('video');
        const resultElem = document.getElementById('result');
        resultElem.textContent = 'Сканирование...';
  
        codeReader = new BrowserMultiFormatReader();
        try {
          controls = await codeReader.decodeFromVideoDevice(
            { facingMode: 'environment' },
            video, (result, err) => {
            if (result) {
              resultElem.textContent = 'Код: ' + result.text;
              controls.stop();
            }
          });
        } catch (e) {
          resultElem.textContent = 'Ошибка: ' + e;
        }
      };
  
      document.getElementById('stop-btn').onclick = () => {
        if (controls) controls.stop();
        document.getElementById('result').textContent = 'Сканирование остановлено.';
      };
    </script>
  </body>
  </html>
  